<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <head>
      <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
      <link
        rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css"
      />
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    </head>

    <title>Document</title>
  </head>
  <body>
    <div id="createvm">Loading...</div>

    <script>
      marked.setOptions({
        highlight: function (code, lang) {
          return hljs.highlight(code, { language: lang }).value;
        },
      });

      fetch("CreateVM.ps1")
        .then((res) => res.text())
        .then((text) => {
          const md = "```powershell\n" + text + "\n```";
          document.getElementById("createvm").innerHTML = marked.parse(md);
        });
    </script>
  </body>
</html>
